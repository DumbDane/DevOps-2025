<%# TODO: How to handle the block title? Public vs. users timeline ....%>
<h2>
    <%= @title %>
</h2>
<% if @user %>
    <% if request.path_info == "/#{@profile_user.username}" %>
        <div class=followstatus>
        <% if @user.user_id == @profile_user.user_id %>
            This is you!
        <% elsif @followed %>
            You are currently following this user.
            <a class="unfollow" href="">Unfollow user</a>.
        <% else %>
            You are not yet following this user.
            <a class="follow" href="">Follow user</a>.
        <% end %>
    <% end %>
<% elsif request.path_info == "/timeline" %>
    <div class="twitbox">
    <h3>What's on your mind <% @user.username? %></h3>
    <form action="" method="post">
        <p><input type="text" name="text" size=60><!--
        --><input type="submit" value="Share">
    </form>
    </div>
<% end %>
<ul class="messages">
    <% if @messages.length > 0 %>
        <% @messages.each do |message| %>
            <li>
                <img src="<%= gravatar_url(message['email'], size=48) %>" alt="User Gravatar" />
                <strong>
                    <a href="<%= message['username'] %>"><%= message['username'] %></a>
                </strong>
                    <%= message['text'] %>
                <small>â€” <%= format_datetime(message['pub_date']) %></small>
            </li>
        <% end %>
    <% else %>
        <li>
            <em>
                There's no messages so far.
            </em>
        </li>
    <% end %>
</ul>